'use strict';const aa=[1.4,5.3,5.9,23.4,35.4,53.9,72.5,78.6,78.6],ba=[0,.3,.6,2,5,12,15,30,40,47,56,75,87,100,100,100],ca=[.3,.3,.8,2.3,4.8,7.5,7.8,11.7,14.4,19.2,22.9,26.9,32.9,40.1,44.6,51.6,59.1,66.1,75.8,77.4,82.9,87.5],da=[0,2,4,6,7],ea=[0,1,3];
let fa="0000-01-01",d=0,ha="",ia="",f=0,g=0,k={f:"testSelection",b:void 0,value:0,i:"Select Test",m:"Test",o:300,l:30,h:void 0,g:["Short Score","Long Score","Isaric Score"],s:["Short","Long","Isaric"],u:420,c:["shortScore","longScore","isaricScore"],a:[],j:[ja,ka,la]},l={f:"spo",b:void 0,value:0,i:"SpO<sub>2</sub> < 92% on Air / 21% O<sub>2</sub>",m:"Sats < 92% RA",o:350,l:65,h:void 0,g:["No","Yes"],c:["nospo","yesspo"],a:[],j:[ma,na]},m={f:"ageRange",b:void 0,value:0,i:"Age",l:30,h:void 0,g:["<50",
"50-59","60-69","70-79",">80"],s:["<50","50s","60s","70s",">80"],u:350,c:["ageless50","age50-59","age60-69","age70-79","agemore80"],a:[],j:[oa,pa,qa,ra,sa]},n={f:"obesity",b:void 0,value:0,i:"Obesity (BMI > 30)",m:"Obese",o:230,l:65,h:void 0,g:["No","Yes"],c:["noobesity","yesobesity"],a:[],j:[ta,ua]},p={f:"stroke",b:void 0,value:0,i:"Stroke",l:65,h:void 0,g:["No","Yes"],c:["nostroke","yesstroke"],a:[],j:[va,wa]},q={f:"resp",b:void 0,value:0,i:"Respiratory Rate >24/min",m:"RR > 24",o:310,l:65,h:void 0,
g:["No","Yes"],c:["noresp","yesresp"],a:[],j:[xa,ya]},r={f:"everSmoker",b:void 0,value:0,i:"Ever Smoker",l:65,h:void 0,g:["No","Yes"],c:["noEverSmoker","yesEverSmoker"],a:[],j:[za,Aa]},t={f:"dementia",b:void 0,value:0,i:"Dementia",l:65,h:void 0,g:["No","Yes"],c:["noDementia","yesDementia"],a:[],j:[Ba,Ca]},u={f:"leucophilia",b:void 0,value:0,i:"Leucophilia (WCC >11)",m:"WCC >11",o:280,l:65,h:void 0,g:["No","Yes"],c:["noLeucophilia","yesLeucophilia"],a:[],j:[Da,Ea]},v={f:"lymphopenia",b:void 0,value:0,
i:"Lymphopenia (Lymphocytes <0.7)",m:"Lymph <0.7",o:400,l:65,h:void 0,g:["No","Yes"],c:["noLymphopenia","yesLymphopenia"],a:[],j:[Fa,Ga]},w={f:"cxrChanges",b:void 0,value:0,i:"CXR Changes (>4 zones)",m:"CXR Changes",o:300,l:65,h:void 0,g:["No","Yes"],c:["noCxrChanges","yesCxrChanges"],a:[],j:[Ha,Ia]},x={f:"ckdStageRange",b:void 0,value:0,i:"Renal Function",m:"CKD",o:380,l:30,h:void 0,g:["CKD 1","CKD 2","CKD 3","CKD 4","CKD 5"],s:["1","2","3","4","5"],u:420,c:["ckd1","ckd2","ckd3","ckd4","ckd5"],a:[],
j:[Ja,Ka,La,Ma,Na]},y={f:"gcs",b:void 0,value:0,i:"GCS < 15",l:65,h:void 0,g:["No","Yes"],c:["noGcs","yesGcs"],a:[],j:[Oa,Pa]},z={f:"male",b:void 0,value:0,i:"Sex at birth",l:65,h:void 0,g:["Female","Male"],s:["F","M"],u:330,c:["femaleSex","maleSex"],a:[],j:[Qa,Ra]},A={f:"comorbidRange",b:void 0,value:0,i:"Comorbidities",l:65,h:void 0,g:["0","1","2+"],c:["comorbid0","comorbid1","comorbid2+"],a:[],j:[Sa,Ta,Ua]},B={f:"tachypneoaRange",b:void 0,value:0,i:"Respiratory Rate",l:65,h:void 0,g:["<20","20-30",
">30"],c:["respRateUnder20","respRate20-29","respRateOver30"],a:[],j:[Va,Wa,Xa]},C={f:"ureaRange",b:void 0,value:0,i:"Urea",l:65,h:void 0,g:["<7","7-14",">14"],c:["ureaUnder7","urea7to14","ureaOver14"],a:[],j:[Ya,Za,$a]},D={f:"crpRange",b:void 0,value:0,i:"CRP",l:65,h:void 0,g:["<50","50-100",">100"],c:["crpUnder50","crp50to100","crpOver100"],a:[],j:[ab,bb,cb]},E=[m,l],F=[q,n,p],G=[r,t,u,v,w,x],H=[y,z,A,B,C,D];
{let a;a=""+db(k);a+=I(E);a+=I(F);a+=I(G);a+=I(H);document.getElementById("generatedHtml").innerHTML+=a}J(k);E.forEach(J);F.forEach(J);G.forEach(J);H.forEach(J);let K=document.getElementById("titleText"),L=document.getElementById("nhsnumber"),M=document.getElementById("name"),N=document.getElementById("surname"),O=document.getElementById("dob"),eb=document.getElementById("resultText"),fb=document.getElementById("submitButton");L.addEventListener("input",gb);L.addEventListener("propertychange",gb);
M.addEventListener("input",hb);M.addEventListener("propertychange",hb);N.addEventListener("input",ib);N.addEventListener("propertychange",ib);O.addEventListener("change",jb);fb.addEventListener("click",kb);P(k);E.forEach(P);F.forEach(P);G.forEach(P);H.forEach(P);window.addEventListener("resize",lb);ja();lb();
function mb(a){var b="0123456789ABCDEFGHJKMNPQRSTVWXYZ".split("");var c=""+b[p.value+2*n.value+4*q.value+8*l.value+(a?16:0)];c+=b[m.value+5*x.value];a&&(c+=b[w.value+2*v.value+4*u.value+8*t.value+16*r.value]);return c}function lb(){Q(x);Q(k);Q(m);Q(l);Q(q);Q(n);Q(u);Q(v);Q(w);Q(z)}function Q(a){var b=a.b.clientWidth,c=a.u,e;a.h.innerHTML=b<a.o?a.m:a.i;for(e=0;e<a.a.length;e++)a.a[e].innerHTML=b<c?a.s[e]:a.g[e]}function db(a){return nb(a.f,a.i,a.c,a.g,a.l)}
function J(a){a.b=document.getElementById(a.f);a.h=document.getElementById(a.f+"Label");var b;for(b=0;b<a.c.length;b++)a.a.push(document.getElementById(a.c[b]))}function P(a){var b;for(b=0;b<a.a.length;b++)a.a[b].addEventListener("click",a.j[b])}function I(a){let b="";var c;for(c=0;c<a.length;c++)b+=db(a[c]);return b}
function nb(a,b,c,e,h=65){if(c.length!=e.length||0>h||100<h)return"";a='<div class="row" id="'+a+'">\n  <div class="multiButtonLabel" id="'+a+'Label" '+(35==h?"":' style="flex-basis: '+h+'%;"')+">\n    "+b+'\n  </div>\n  <div class="multiButtonContainer"'+(35==h?"":' style="flex-basis: '+(100-h)+'%;"')+">\n";for(b=0;b<c.length;b++)h="multiButton",0==b&&1==c.length?h+=" bothEnds":0==b?h+=" leftEnd":b+1==c.length&&(h+=" rightEnd"),a+='    <div id="'+c[b]+'" class="'+h+'">\n      '+e[b]+"\n    </div>\n";
return a+"  </div>\n</div>\n"}
function R(){var a="",b="",c="";switch(g){case 0:f=m.value+l.value+q.value+p.value+n.value;b=" ("+mb(!1)+")";a=(8==f?">":"")+aa[f]+"%";c=f;var e;2>c?e="<p><strong>Green Pathway</strong><br />1. Discharge to the Virtual Hospital<br />2. Provide advice pack and Pulse Oximeter<br />3. Consider calling #7854 to discuss VH Drug Trial Eligibility, and provide Patient Information Leaflet and Consent Form to read.</p>":2==c?e="<p><strong>Orange Pathway</strong><br /><span>1. Discuss with Medical Registrar / Consultant RE need for admission</span><br /><span>&nbsp; &nbsp; - If Low Risk, treat as Green Pathway</span><br /><span>2. If High Risk, Calculate SOARS Long Score</span><br /><span>&nbsp; &nbsp; - assess O</span><sub>2</sub><span>&nbsp;Requirements, Obtain bloods (FBCs, U+Es, LFTs, CRP) and CXR</span><br /><span>3. If Long Score &lt;7, consider conscious proning</span><br /><span>4. If Long Score &ge;7:</span><br /><span>&nbsp; &nbsp; - Add additional bloods: Ferritin, D-Dimer, Procalcitonin, BNP, LDH, LDH, Troponin</span><br /><span>&nbsp; &nbsp; - Consider fast-track COVID swab if MI or Stroke suspected</span><br /><span>&nbsp; &nbsp; - Consider IV Fluids</span><br /><span>&nbsp; &nbsp; - Consider Antibiotics per local antimicrobial policy and review when procalcitonin reported<br />&nbsp; &nbsp; - Consider Dexamethasone<br /></span><span>&nbsp; &nbsp; - Assess Clinical Frailty / Rockwell Score</span><br /><span>&nbsp; &nbsp; - Consider and discuss appropriate escalation and resuscitation status</span><br /><span>&nbsp; &nbsp; - Consider need for escalation of care</span></p>":2<
c&&(e="<p><strong>Red Pathway</strong><br />1. Calculate SOARS Long Score<br />&nbsp; &nbsp; - assess O<sub>2</sub> Requirements, Obtain bloods (FBCs, U+Es, LFTs, CRP) and CXR<br />2. If Long Score &lt;7, consider conscious proning<br />3. If Long Score &ge;7,<br />&nbsp; &nbsp; - Add additional bloods: Ferritin, D-Dimer, Procalcitonin, BNP, LDH, LDH, Troponin<br />&nbsp; &nbsp; - Consider fast-track COVID swab if MI or Stroke suspected<br />&nbsp; &nbsp; - Consider IV Fluids<br />&nbsp; &nbsp; - Consider Antibiotics per local antimicrobial policy and review when procalcitonin reported<br />&nbsp; &nbsp; - Assess Clinical Frailty / Rockwell Score<br />&nbsp; &nbsp; - Consider and discuss appropriate escalation and resuscitation status<br />&nbsp; &nbsp; - Consider need for escalation of care</p>");
c=e;break;case 1:f=m.value+l.value+q.value+p.value+n.value+r.value+t.value+u.value+v.value+w.value+x.value+1;b=" ("+mb(!0)+")";a=ba[f]+"%";break;case 2:f=da[m.value]+ea[C.value]+z.value+A.value+B.value+2*l.value+2*y.value+D.value,a=(0==f?"<":"")+ca[f]+"%"}eb.innerHTML='<p style="font-size:30px;margin:0px;padding:0px;"> Score = '+f+" "+b+'</p> <p style="font-size:30px;margin:0px;padding:0px;"> Mortality risk: '+a+"</p><hr>"+c}
function ja(){g=0;K.innerHTML="SOARS Short Score";S(0);F.forEach(T);G.forEach(U);H.forEach(U);R()}function ka(){g=1;K.innerHTML="SOARS Long Score";S(1);F.forEach(T);H.forEach(U);G.forEach(T);R()}function la(){g=2;K.innerHTML="ISARIC score";S(2);F.forEach(U);G.forEach(U);H.forEach(T);R()}function V(a,b){a.style.backgroundColor=b?"#0066cc":"lightgray";a.style.color=b?"white":"black"}function ob(a){V(a,!1)}function S(a){var b=k.a;b.forEach(ob);V(b[a],!0)}
function W(a,b){a.value=b;a.a.forEach(ob);V(a.a[b],!0);R()}function X(a,b){a.style.backgroundColor=b?"green":"orange";a.style.color=b?"white":"black"}function Y(a){a.style.backgroundColor="lightgray";a.style.color="black"}function T(a){try{a.b.style.display="flex"}catch(b){return!1}}function U(a){try{a.b.style.display="none"}catch(b){return!1}}function xa(){W(q,0)}function ya(){W(q,1)}function ma(){W(l,0)}function na(){W(l,1)}function va(){W(p,0)}function wa(){W(p,1)}function ta(){W(n,0)}
function ua(){W(n,1)}function za(){W(r,0)}function Aa(){W(r,1)}function Ba(){W(t,0)}function Ca(){W(t,1)}function Da(){W(u,0)}function Ea(){W(u,1)}function Fa(){W(v,0)}function Ga(){W(v,1)}function Ha(){W(w,0)}function Ia(){W(w,1)}function oa(){Z(0,0,50)}function pa(){Z(1,50,60)}function qa(){Z(2,60,70)}function ra(){Z(3,70,80)}function sa(){Z(4,80,0)}function Z(a,b,c){W(m,a);b&&c?d=d>=b&&d<c?d:0:b&&!c?d=d>=b?d:0:!b&&c&&(d=d<c?d:0);d?X(O,!0):(O.value="",Y(O));R()}function Ja(){W(x,0)}
function Ka(){W(x,1)}function La(){W(x,2)}function Ma(){W(x,3)}function Na(){W(x,4)}function Oa(){W(y,0)}function Pa(){W(y,1)}function Qa(){W(z,0)}function Ra(){W(z,1)}function Sa(){W(A,0)}function Ta(){W(A,1)}function Ua(){W(A,2)}function Va(){W(B,0)}function Wa(){W(B,1)}function Xa(){W(B,2)}function Ya(){W(C,0)}function Za(){W(C,1)}function $a(){W(C,2)}function ab(){W(D,0)}function bb(){W(D,1)}function cb(){W(D,2)}function hb(){M.value.length?(X(M,!0),ha=M):Y(M)}
function ib(){N.value.length?(X(N,!0),ia=N):Y(N)}function jb(){let a=Date.now()-Date.parse(O.value);d=Math.floor(a/315576E5);fa=O.value;80<=d?sa():70<=d?ra():60<=d?qa():50<=d?pa():oa();return!0}
function gb(){var a=L.value;a=a.replace(/\s/g,"");if(a=isNaN(a)||0>a||10!==String(a).length?0:a){X(L,!1);a.replace(/\s/g,"");var b=a.toString().split("");var c,e=0;for(c=0;9>c;c++)e+=b[c]*(10-c);c=11-e%11;10==c?b=!1:(11==c&&(c=0),b=c==b[9]);!b||3999999999>a&&32E8<a||3112999999>a&&10101E4<a||(eb.innerHTML='<p style="font-size:35px;"> NHS number appears to be valid...</p>',X(L,!0))}else Y(L)}
function kb(){{var a={C:0,B:ha,J:ia,A:fa,v:m.value,F:q.value,H:l.value,I:p.value,D:n.value,G:f};const b=document.createElement("form");b.method="post";b.action="http://15.161.6.195:3000/sendData";for(const c in a)if(a.hasOwnProperty(c)){const e=document.createElement("input");e.type="hidden";e.name=c;e.value=a[c];b.appendChild(e)}document.body.appendChild(b);b.submit()}};